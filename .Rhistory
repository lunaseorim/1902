s_u$msgBody[j]$busRouteStationList$mobileNo
class(37662          37662-37661  600
37852          37852-37662  500
36995          36995-37852  300
37694          37694-36995  300
37695          37695-37694  400
37711          37711-37695  300
37712          37712-37711  400
37864          37864-37712  400
37954          37954-37864  1000
36406          36406-37954  1000
36403          36403-36406  500
36395          36395-36403  700
36392          36392-36395  400
36389          36389-36392  500
36388          36388-36389  400
36710          36710-36388  400
36380          36380-36710  300
36370          36370-36380  400
36795          36795-36370  200
55279          55279-36795  400
36354          36354-55279  300
36345(병점)   36345-36354  1100
36062          36062-36345  300
37738          37738-36062  500
37728          37728-37738  300
36369          36369-37728  500
36376          36376-36369  300
37591          37591-36376  100
37727          37727-37591  100
37726          37726-37727  100
37863          37863-37726  300
55100          55100-37863  200
37789          37789-55100  200
37850          37850-37789  400
37953          37953-37850  400
37589          37589-37953  400
37584          37584-37589  800
37585          37585-37584  300
36948          36948-37585  200
37662          37662-36948  500)
class(s_u$msgBody[j]$busRouteStationList$mobileNo)
s_u$msgBody[j]$busRouteStationList$mobileNo
as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j2 <- rbind(data.frame(),j1)
}
j1
j1 <- data.frame()
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j2 <- rbind(data.frame(),j1)
}
View(j1)
for (i in 1:104) {
get <- getForm(paste0(url,api_key,"&routeId=", routelist$노선id[i]))
s_u <- xmlToList(get)
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j2 <- rbind(data.frame(),j1)
}
s_u_fine <- c(s_u_fine,j2)
cat(i,"/104","\n")
}
j2 <- data.frame()
j2 <- rbind(data.frame(),j1)
View(j2)
s_u_fine <- data.frame()
for (i in 1:104) {
get <- getForm(paste0(url,api_key,"&routeId=", routelist$노선id[i]))
s_u <- xmlToList(get)
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j2 <- rbind(data.frame(),j1)
}
s_u_fine <- rbind(s_u_fine,j2)
j2 <- data.frame()
cat(i,"/104","\n")
}
final <- read.csv("data/aaaaa.csv")
system.time(
finally_we_find <-foreach(i=1:500,.combine = rbind) %dopar%{
a <- which(final$id[i] == A2$정류소번호)
b <- A2[a,c(3,9:10)]
b
})
library(plyr)
library(dplyr)
library(doParallel)
library(tidygraph)
library(ggraph)
library(tidyverse)
library(mapdeck)
key = "pk.eyJ1IjoibHVuYXNlb3JpbSIsImEiOiJjazJjd3A0Z3IwajAzM2RvMjJvNWdqOGM5In0.C8bch4gbQBoRMccrAeCv8Q"
library(arules)
library(rgdal)
library(geosphere)
#병렬화 중지
stopCluster(cl)
detectCores()
cl <- makeCluster(7)
registerDoParallel(cl)
system.time(
finally_we_find <-foreach(i=1:500,.combine = rbind) %dopar%{
a <- which(final$id[i] == A2$정류소번호)
b <- A2[a,c(3,9:10)]
b
})
View(final)
system.time(
finally_we_find <-foreach(i=1:39,.combine = rbind) %dopar%{
a <- which(final$X37662[i] == A2$정류소번호)
b <- A2[a,c(3,9:10)]
b
})
View(finally_we_find)
final_fine <- cbind(final[-39,],finally_we_find)
View(final_fine)
final <- read.csv("data/aaaaa.csv")
system.time(
finally_we_find <-foreach(i=1:39,.combine = rbind) %dopar%{
a <- which(final$X37662[i] == A2$정류소번호)
b <- A2[a,c(3,9:10)]
b
})
system.time(
finally_we_find <-foreach(i=1:39,.combine = rbind) %dopar%{
a <- which(final$id[i] == A2$정류소번호)
b <- A2[a,c(3,9:10)]
b
})
final_fine <- cbind(final[-39,],finally_we_find)
View(finally_we_find)
View(A2)
system.time(
finally_we_find <-foreach(i=1:40,.combine = rbind) %dopar%{
a <- which(final$id[i] == A2$정류소번호)
b <- A2[a,c(3,5,9:10)]
b
})
View(finally_we_find)
View(finally_we_find)
final_fine <- merge(x=final,y=finally_we_find,by.x="id",by.y="정류소번호",all.x=T)
View(final_fine)
final_fine[1,3:5]<-c("홈플러스병점점",37.2042,127.037578)
final_fine[1,3:5]<-c("홈플러스병점점","37.2042","127.037578")
View(final_fine)
final_fine[1,3]<-"홈플러스병점점"
View(final_fine)
View(final)
View(final_fine)
View(final)
final$num <- 1:40
system.time(
finally_we_find <-foreach(i=1:40,.combine = rbind) %dopar%{
a <- which(final$id[i] == A2$정류소번호)
b <- A2[a,c(3,5,9:10)]
b
})
View(finally_we_find)
final_fine <- merge(x=final,y=finally_we_find,by.x="id",by.y="정류소번호",all.x=T)
View(final_fine)
final_fine[1,3:5]<-c("홈플러스병점점","37.2042","127.037578")
final_fine <- merge(x=final,y=finally_we_find,by.x="id",by.y="정류소번호",all.x=T)
final_fine[1,4:6]<-c("홈플러스병점점","37.2042","127.037578")
final_fine_orderd <- final_fine[order(final_fine$num,decreasing = F),]
View(final_fine_orderd)
rownames(final_fine_orderd)
rownames(final_fine_orderd) <- 1:42
final_fine_orderd[c(-1,-42),]
finalfineaaa <- final_fine_orderd[c(-1,-42),]
View(finalfineaaa)
finalfineaaa[1,2]
finalfineaaa[1,2]<-0
c1 <- sum(finalfineaaa$leng)
rownames(finalfineaaa)
rownames(finalfineaaa)<-1:40
i=1
sqrt((finalfineaaa[i,10]-finalfineaaa[i+1,10])^2+(finalfineaaa[i,11]-finalfineaaa[i+1,11])^2)*100000
sqrt((finalfineaaa[i,5]-finalfineaaa[i+1,5])^2+(finalfineaaa[i,6]-finalfineaaa[i+1,6])^2)*100000
i
finalfineaaa$WGS84위도 <- as.integer(finalfineaaa$WGS84위도)
finalfineaaa$WGS84경도 <- as.integer(finalfineaaa$WGS84경도)
sqrt((finalfineaaa[i,5]-finalfineaaa[i+1,5])^2+(finalfineaaa[i,6]-finalfineaaa[i+1,6])^2)*100000
View(final_fine)
finalfineaaa <- final_fine[order(final_fine$num,decreasing = F),]
finalfineaaa [1,]
finalfineaaa<-finalfineaaa[-1,]
View(finalfineaaa)
rownames(finalfineaaa)
rownames(finalfineaaa) <- 1:41
View(finalfineaaa)
finalfineaaa<-finalfineaaa[-41,]
View(finalfineaaa)
finalfineaaa$WGS84경도 <- as.numeric(finalfineaaa$WGS84경도)
str(finalfineaaa)
finalfineaaa$WGS84위도 <- as.numeric(finalfineaaa$WGS84위도)
sqrt((finalfineaaa[i,5]-finalfineaaa[i+1,5])^2+(finalfineaaa[i,6]-finalfineaaa[i+1,6])^2)*100000
c2 <- NULL
for (i in 1:40) {
c2 <- sqrt((finalfineaaa[i,5]-finalfineaaa[i+1,5])^2+(finalfineaaa[i,6]-finalfineaaa[i+1,6])^2)*100000
c(c2,c2)
}
c2
for (i in 1:40) {
c2 <- sqrt((finalfineaaa[i,5]-finalfineaaa[i+1,5])^2+(finalfineaaa[i,6]-finalfineaaa[i+1,6])^2)*100000
c2
}
c1<-NULL
for (i in 1:40) {
c2 <- sqrt((finalfineaaa[i,5]-finalfineaaa[i+1,5])^2+(finalfineaaa[i,6]-finalfineaaa[i+1,6])^2)*100000
c(c1,c2)
}
for (i in 1:40) {
c2 <- sqrt((finalfineaaa[i,5]-finalfineaaa[i+1,5])^2+(finalfineaaa[i,6]-finalfineaaa[i+1,6])^2)*100000
c2
}
sqrt((finalfineaaa[i,5]-finalfineaaa[i+1,5])^2+(finalfineaaa[i,6]-finalfineaaa[i+1,6])^2)*100000
i=1
sqrt((finalfineaaa[i,5]-finalfineaaa[i+1,5])^2+(finalfineaaa[i,6]-finalfineaaa[i+1,6])^2)*100000
c2 <- NULL
for (i in 1:40) {
c2[i] <- sqrt((finalfineaaa[i,5]-finalfineaaa[i+1,5])^2+(finalfineaaa[i,6]-finalfineaaa[i+1,6])^2)*100000
}
c2
finalfineaaa$asdf <- c(0,c2[1:39])
View(finalfineaaa)
finalfineaaa$leng[2:40]/finalfineaaa$asdf[2:40]
mean(finalfineaaa$leng[2:40]/finalfineaaa$asdf[2:40])
ok <- data.frame(id = c(36406,36345,37662))
View(ok)
sqrt((37.23063-37.20692)^2+(127.0681-127.0356)^2)*100000
sqrt((37.23063-37.20692)^2+(127.0681-127.0356)^2)*100000/4900
4900/sqrt((37.23063-37.20692)^2+(127.0681-127.0356)^2)*100000
4900/(sqrt((37.23063-37.20692)^2+(127.0681-127.0356)^2)*100000)
sqrt((37.19715-37.20692)^2+(127.0726-127.0356)^2)*100000
(sqrt((37.19715-37.23063)^2+(127.0726-127.0356)^2)*100000)
(sqrt((37.19715-37.23063)^2+(127.0681-127.0356)^2)*100000)
(sqrt((37.19715-37.23063)^2+(127.0681-127.0726)^2)*100000)
(sqrt((37.19715-37.23063)^2+(127.0681-127.0726)^2)*100000)
(sqrt((37.19715-37.23063)^2+(127.0726-127.0681)^2)*100000)
4475/(sqrt((37.19715-37.23063)^2+(127.0726-127.0681)^2)*100000)
(sqrt((37.19715-37.23063)^2+(127.0726-127.0681)^2)*100000)
5050(sqrt((37.19715-37.23063)^2+(127.0726-127.0681)^2)*100000)
5050/(sqrt((37.19715-37.23063)^2+(127.0726-127.0681)^2)*100000)
View(finalfineaaa)
finalfineaaa$leng[2:40]/finalfineaaa$asdf[2:40]
a <- finalfineaaa$leng[2:40]/finalfineaaa$asdf[2:40]
a[a<0]
a
class(a)
a<0
5050/(sqrt((37.20692-37.19312)^2+(127.0356-127.0731)^2)*100000)
5650/(sqrt((37.20692-37.19312)^2+(127.0356-127.0731)^2)*100000)
(sqrt((37.20692-37.19312)^2+(127.0356-127.0731)^2)*100000)
distm(c(37.20692,37.19312),c(127.0356,127.0731))
distm(c(37.20692,37.19312),c(127.0356,127.0731)-90)
distm(c(37.20692,37.19312),c(127.0356,127.0731)-90)
distm(c(37.20692,37.19312),c(127.0356,127.0731)-60)
distm(c(37.20692,37.19312),c(127.0356,127.0731)-90)
c(127.0356,127.0731)-90
distm(c(37.20692,37.19312),-c(127.0356,127.0731))
distm(c(37.20692,37.19312),c(127.0356,127.0731)-90,fun=distHaversine)
(sqrt((37.20692-37.19312)^2+(127.0356-127.0731)^2)*100000)
(sqrt((37.20692-37.19312)^2+(127.0356-127.0731)^2)*100000)
5100(sqrt((37.20692-37.19312)^2+(127.0356-127.0731)^2)*100000)
5100/(sqrt((37.20692-37.19312)^2+(127.0356-127.0731)^2)*100000)
5650/(sqrt((37.20692-37.19312)^2+(127.0356-127.0731)^2)*100000)
5650/3659
4900/3903
5700/4194
5100/4194
(sqrt((37.20692-37.19312)^2+(127.0356-127.0731)^2)*100000)
#1-2 3903
4900/3903
#2-3 3659
5700/3659
#3-1 4194
5100/4194
length(s_u$msgBody)
for (i in 1:104) {
get <- getForm(paste0(url,api_key,"&routeId=", routelist$노선id[i]))
s_u <- xmlToList(get)
j2 <- data.frame()
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j2 <- rbind(data.frame(),j1)
}
s_u_fine <- rbind(s_u_fine,j2)
cat(i,"/104","\n")
}
1:length(s_u$msgBody)
api_key <- "dNPaIgkwOZ7owR99PJO%2BFsKmOF%2BletE5UwU%2FRfzki60YiHvBLwgygiuuVzXq63d2R7fuflBfpXk6rWMBLrlYRw%3D%3D"
url = "http://openapi.gbis.go.kr/ws/rest/busrouteservice/station?serviceKey="
library(XML)
library(RCurl)
library(dplyr)
s_u_fine <- data.frame()
j2 <- data.frame()
j1 <- data.frame()
for (i in 1:104) {
get <- getForm(paste0(url,api_key,"&routeId=", routelist$노선id[i]))
s_u <- xmlToList(get)
j2 <- data.frame()
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j2 <- rbind(data.frame(),j1)
}
s_u_fine <- rbind(s_u_fine,j2)
cat(i,"/104","\n")
}
i
get <- getForm(paste0(url,api_key,"&routeId=", routelist$노선id[i]))
s_u <- xmlToList(get)
j2 <- data.frame()
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j2 <- rbind(data.frame(),j1)
}
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j
j=1
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j
j1
j2 <- rbind(data.frame(),j1)
View(j2)
j=2
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j2 <- rbind(data.frame(),j1)
View(j2)
j2 <- data.frame()
j1 <- data.frame()
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j2 <- rbind(data.frame(),j2)
}
as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
View(s_u)
as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j
j=1
as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- as.integer(s_u$msgBody[j]$busRouteStationList$mobileNo)
j2 <- rbind(data.frame(),j2)
}
length(s_u$msgBody)
s_u$msgBody[j]$busRouteStationList$mobileNo
j
length(s_u$msgBody[j]$busRouteStationList$mobileNo)
j1[j,1] <- ifelse(!s_u$msgBody[j]$busRouteStationList$mobileNo)==0,
NA,
s_u$msgBody[j]$busRouteStationList$mobileNo)
j1[j,1] <- ifelse(!length(s_u$msgBody[j]$busRouteStationList$mobileNo))==0,
NA,s_u$msgBody[j]$busRouteStationList$mobileNo)
j1[j,1] <- ifelse(!length(s_u$msgBody[j]$busRouteStationList$mobileNo))==0,
"NA",s_u$msgBody[j]$busRouteStationList$mobileNo)
!length(s_u$msgBody[j]$busRouteStationList$mobileNo))==0
length(s_u$msgBody[j]$busRouteStationList$mobileNo))
length(s_u$msgBody[j]$busRouteStationList$mobileNo)
j1[j,1] <- ifelse(!length(s_u$msgBody[j]$busRouteStationList$mobileNo)==0,
"NA",s_u$msgBody[j]$busRouteStationList$mobileNo)
j1[j,1] <- ifelse(!length(s_u$msgBody[j]$busRouteStationList$mobileNo)==0,
NA,s_u$msgBody[j]$busRouteStationList$mobileNo)
View(j1)
j1[j,1] <- ifelse(!length(s_u$msgBody[j]$busRouteStationList$mobileNo)==NULL,
NULL,s_u$msgBody[j]$busRouteStationList$mobileNo)
length(s_u$msgBody[j]$busRouteStationList$mobileNo)==NULL
s_u$msgBody[j]$busRouteStationList$mobileNo==NULL
!s_u$msgBody[j]$busRouteStationList$mobileNo==NULL
!length(s_u$msgBody[j]$busRouteStationList$mobileNo)
length(s_u$msgBody[j]$busRouteStationList$mobileNo)==0L
!length(s_u$msgBody[j]$busRouteStationList$mobileNo)==0L
length(s_u$msgBody[j]$busRouteStationList$mobileNo)
ength(s_u$msgBody[j]$busRouteStationList$mobileNo)==0
length(s_u$msgBody[j]$busRouteStationList$mobileNo)==0
j1[j,1] <- ifelse(length(s_u$msgBody[j]$busRouteStationList$mobileNo)==0,
NULL,s_u$msgBody[j]$busRouteStationList$mobileNo)
View(j1)
length(s_u$msgBody[j]$busRouteStationList$mobileNo)>0
j1[j,1] <- ifelse(length(s_u$msgBody[j]$busRouteStationList$mobileNo)>0,
s_u$msgBody[j]$busRouteStationList$mobileNo,NA)
View(j1)
j1 <- data.frame()
j2 <- data.frame()
s_u_fine <- data.frame()
for (i in 1:104) {
get <- getForm(paste0(url,api_key,"&routeId=", routelist$노선id[i]))
s_u <- xmlToList(get)
j2 <- data.frame()
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- ifelse(length(s_u$msgBody[j]$busRouteStationList$mobileNo)>0,
s_u$msgBody[j]$busRouteStationList$mobileNo,NA)
j2 <- rbind(data.frame(),j2)
}
s_u_fine <- rbind(s_u_fine,j2)
cat(i,"/104","\n")
}
okfine2 <- data.frame(table(s_u_fine))
j1[j,1] <- ifelse(length(s_u$msgBody[j]$busRouteStationList$mobileNo)>0,
s_u$msgBody[j]$busRouteStationList$mobileNo,NA)
j
j2 <- rbind(data.frame(),j1)
j2 <- rbind(data.frame(),j1)
j2 <- rbind(data.frame(),j1)
j2 <- rbind(data.frame(),j1)
j2 <- rbind(data.frame(),j1)
j1 <- data.frame()
j2 <- data.frame()
s_u_fine <- data.frame()
for (i in 1:104) {
get <- getForm(paste0(url,api_key,"&routeId=", routelist$노선id[i]))
s_u <- xmlToList(get)
j2 <- data.frame()
for (j in 1:length(s_u$msgBody)) {
j1[j,1] <- ifelse(length(s_u$msgBody[j]$busRouteStationList$mobileNo)>0,
s_u$msgBody[j]$busRouteStationList$mobileNo,NA)
j2 <- rbind(data.frame(),j1)
}
s_u_fine <- rbind(s_u_fine,j2)
cat(i,"/104","\n")
}
okfine2 <- data.frame(table(s_u_fine))
View(okfine2)
barplot(okfine2)
barplot(okfine2$Freq)
barplot(okfine2$Freq[order(okfine2$Freq,decreasing = T)[1:30]])
barplot(okfine2$Freq[order(okfine2$Freq,decreasing = T)[1:10]])
barplot(okfine2$Freq[order(okfine2$Freq,decreasing = T)[1:100]])
View(routelist)
library(plyr)
library(dplyr)
library(ggplot2)
library(survival)
library(survminer)
library(caret)
dat<-lung %>%
na.omit() %>%
data.frame()
set.seed(1119)
q1<-dat[sample(nrow(dat))[1:55],]
q2<-dat[sample(nrow(dat))[56:111],]
q3<-dat[sample(nrow(dat))[112:167],]
train1 <- rbind(q1,q2)
test1 <- q3
train2 <- rbind(q2,q3)
test2 <- q1
train3 <- rbind(q1,q3)
test3 <- q2
for (i in 4:10) {
a <- coxph(Surv(time,status==2)~train1[,i],data = train1)
print(paste0("i=",colnames(train1)[i]))
print(summary(a))
}
a
a$coefficients
a$var
a$loglik
a$score
a
a$
for (i in c(4,6:10)) {
for (i in c(4,6,7,9,10)) {
a <- coxph(Surv(time,status==2)~sex+pat.karno+train1[,i],data = train1)
print(paste0("i=",colnames(train1)[i]))
print(summary(a))
}
a$assign
for (i in 4:10) {
a <- coxph(Surv(time,status==2)~train1[,i],data = train1)
print(paste0("i=",colnames(train1)[i]))
print(summary(a))
}
for (i in 4:10) {
a <- coxph(Surv(time,status==2)~train1[,i],data = train1)
print(paste0("i=",colnames(train1)[i]))
print(summary(a))
}
a$
fo
a$iter
a$y
a$linear.predictors
a$formula
a$call
a$concordance
a$wald.test
a$terms
a$terms
a$nevent
a$method
a$means
a$var
a$
for (i in c(4,6:10)) {
summary(a)
summary(a)$sctest
str(summary(a))
summary(a)
str(summary(a))
str(summary(a))
summary(a)
str(summary(a))
str(summary(a))$coefficients
summary(a)$coefficients
summary(a)$coefficients[5]
summary(a)$coefficients[5]
tet <- data.frame()
summary(a)$sctest
summary(a)$rsq
